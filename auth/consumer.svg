<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="982px" preserveAspectRatio="none" style="width:1116px;height:982px;" version="1.1" viewBox="0 0 1116 982" width="1116px" zoomAndPan="magnify"><defs><filter height="300%" id="f5yg362xgo49q" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter><filter height="1" id="b5yg362xgo49q0" width="1" x="0" y="0"><feFlood flood-color="#FF0000" result="flood"/><feComposite in="SourceGraphic" in2="flood" operator="over"/></filter><filter height="1" id="b5yg362xgo49q1" width="1" x="0" y="0"><feFlood flood-color="#0000FF" result="flood"/><feComposite in="SourceGraphic" in2="flood" operator="over"/></filter><filter height="1" id="b5yg362xgo49q2" width="1" x="0" y="0"><feFlood flood-color="#008000" result="flood"/><feComposite in="SourceGraphic" in2="flood" operator="over"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f5yg362xgo49q)" height="230.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="599" y="189.6953"/><rect fill="#FFFFFF" filter="url(#f5yg362xgo49q)" height="360.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="599" y="536.3594"/><rect fill="#FFFFFF" filter="url(#f5yg362xgo49q)" height="404.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="937" y="492.0938"/><rect fill="#FFFFFF" filter="url(#f5yg362xgo49q)" height="650.1953" style="stroke: #000000; stroke-width: 2.0;" width="1056" x="48" y="246.8281"/><rect fill="#FFFFFF" height="603.9297" style="stroke: none; stroke-width: 1.0;" width="1056" x="48" y="293.0938"/><rect fill="#FFFFFF" filter="url(#f5yg362xgo49q)" height="254.3984" style="stroke: #000000; stroke-width: 2.0;" width="848" x="170" y="635.625"/><rect fill="#FFFFFF" height="73.0703" style="stroke: none; stroke-width: 1.0;" width="848" x="170" y="816.9531"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="219" x2="219" y1="86.2969" y2="125.4297"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="219" x2="219" y1="125.4297" y2="153.4297"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="219" x2="219" y1="153.4297" y2="427.8281"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="219" x2="219" y1="427.8281" y2="455.8281"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="219" x2="219" y1="455.8281" y2="914.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="450" x2="450" y1="86.2969" y2="125.4297"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="450" x2="450" y1="125.4297" y2="153.4297"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="450" x2="450" y1="153.4297" y2="427.8281"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="450" x2="450" y1="427.8281" y2="455.8281"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="450" x2="450" y1="455.8281" y2="914.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="604" x2="604" y1="86.2969" y2="125.4297"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="604" x2="604" y1="125.4297" y2="153.4297"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="604" x2="604" y1="153.4297" y2="427.8281"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="604" x2="604" y1="427.8281" y2="455.8281"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="604" x2="604" y1="455.8281" y2="914.0234"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="942" x2="942" y1="86.2969" y2="125.4297"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="942" x2="942" y1="125.4297" y2="153.4297"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="942" x2="942" y1="153.4297" y2="427.8281"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="942" x2="942" y1="427.8281" y2="455.8281"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="942" x2="942" y1="455.8281" y2="914.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="180" y="82.9951">Consumer</text><ellipse cx="219" cy="13" fill="#FEFECE" filter="url(#f5yg362xgo49q)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M219,21 L219,48 M206,29 L232,29 M219,48 L206,63 M219,48 L232,63 " fill="none" filter="url(#f5yg362xgo49q)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f5yg362xgo49q)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="150" x="373" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="136" x="380" y="70.9951">IUDX Catalog server</text><rect fill="#FEFECE" filter="url(#f5yg362xgo49q)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="130" x="537" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="116" x="544" y="70.9951">IUDX Auth server</text><rect fill="#FEFECE" filter="url(#f5yg362xgo49q)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="128" x="876" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="114" x="883" y="70.9951">Resource server</text><rect fill="#FFFFFF" filter="url(#f5yg362xgo49q)" height="230.1328" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="599" y="189.6953"/><rect fill="#FFFFFF" filter="url(#f5yg362xgo49q)" height="360.6641" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="599" y="536.3594"/><rect fill="#FFFFFF" filter="url(#f5yg362xgo49q)" height="404.9297" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="937" y="492.0938"/><polygon fill="#0000FF" points="438,113.4297,448,117.4297,438,121.4297,442,117.4297" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="219" x2="444" y1="117.4297" y2="117.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="226" y="112.3638">[1]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="251" y="112.3638">Search catalog for data-sets</text><polygon fill="#008000" points="587,185.6953,597,189.6953,587,193.6953,591,189.6953" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="219" x2="593" y1="189.6953" y2="189.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="226" y="177.063">[2]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="251" y="169.4966">HTTPS POST /auth/v1/token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="332" x="251" y="184.6294">body={"request" : list of resource IDs from catalog}</text><path d="M8,160.9961 L8,185.9961 L210,185.9961 L210,170.9961 L200,160.9961 L8,160.9961 " fill="#FBFB77" filter="url(#f5yg362xgo49q)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M200,160.9961 L200,170.9961 L210,170.9961 L200,160.9961 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="14" y="178.063">Request for an access token</text><line style="stroke: #FF0000; stroke-width: 1.0;" x1="609" x2="651" y1="218.8281" y2="218.8281"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="651" x2="651" y1="218.8281" y2="231.8281"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="610" x2="651" y1="231.8281" y2="231.8281"/><polygon fill="#FF0000" points="620,227.8281,610,231.8281,620,235.8281,616,231.8281" style="stroke: #FF0000; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="616" y="213.7622">[3]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="285" x="641" y="213.7622">Check data provider's access control policies</text><path d="M48,246.8281 L112,246.8281 L112,253.8281 L102,263.8281 L48,263.8281 L48,246.8281 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="650.1953" style="stroke: #000000; stroke-width: 2.0;" width="1056" x="48" y="246.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="63" y="259.895">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="193" x="127" y="259.0386">[Consumer is NOT authorized]</text><polygon fill="#008000" points="230,281.0938,220,285.0938,230,289.0938,226,285.0938" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="224" x2="598" y1="285.0938" y2="285.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="236" y="280.0278">[4]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="261" y="280.0278">HTTP 403 Forbidden</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="48" x2="1104" y1="294.0938" y2="294.0938"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="162" x="53" y="304.3042">[Consumer is authorized]</text><polygon fill="#008000" points="230,415.8281,220,419.8281,230,423.8281,226,419.8281" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="224" x2="603" y1="419.8281" y2="419.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="236" y="369.3638">[5]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="265" y="323.9653"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="261" y="339.0981">HTTP 200 OK</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="261" y="354.231">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="293" y="369.3638">token:&lt;token&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="293" y="384.4966">token-type:IUDX</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="293" y="399.6294">expires-in:&lt;expiry-in-seconds&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="261" y="414.7622">}</text><path d="M58,353.2969 L58,378.2969 L210,378.2969 L210,363.2969 L200,353.2969 L58,353.2969 " fill="#FBFB77" filter="url(#f5yg362xgo49q)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M200,353.2969 L200,363.2969 L210,363.2969 L200,353.2969 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="64" y="370.3638">Token and its details</text><polygon fill="#0000FF" points="925,488.0938,935,492.0938,925,496.0938,929,492.0938" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="219" x2="931" y1="492.0938" y2="492.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="226" y="479.4614">[6]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="221" x="251" y="471.895">HTTPS GET &lt;resource-server-api&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="186" x="251" y="487.0278">Authorization: IUDX &lt;token&gt;</text><polygon fill="#008000" points="620,532.3594,610,536.3594,620,540.3594,616,536.3594" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="614" x2="936" y1="536.3594" y2="536.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="626" y="523.7271">[7]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="243" x="651" y="516.1606">HTTPS POST /auth/v1/token/introspect</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="651" y="531.2935">body={"token": &lt;token&gt;}</text><path d="M952,507.6602 L952,532.6602 L1090,532.6602 L1090,517.6602 L1080,507.6602 L952,507.6602 " fill="#FBFB77" filter="url(#f5yg362xgo49q)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1080,507.6602 L1080,517.6602 L1090,517.6602 L1080,507.6602 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="958" y="524.7271">Validate the token</text><line style="stroke: #FF0000; stroke-width: 1.0;" x1="609" x2="651" y1="565.4922" y2="565.4922"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="651" x2="651" y1="565.4922" y2="578.4922"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="610" x2="651" y1="578.4922" y2="578.4922"/><polygon fill="#FF0000" points="620,574.4922,610,578.4922,620,582.4922,616,578.4922" style="stroke: #FF0000; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="616" y="560.4263">[8]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="289" x="641" y="560.4263">Verify resource-server's identity through DNS</text><line style="stroke: #FF0000; stroke-width: 1.0;" x1="609" x2="651" y1="607.625" y2="607.625"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="651" x2="651" y1="607.625" y2="620.625"/><line style="stroke: #FF0000; stroke-width: 1.0;" x1="610" x2="651" y1="620.625" y2="620.625"/><polygon fill="#FF0000" points="620,616.625,610,620.625,620,624.625,616,620.625" style="stroke: #FF0000; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="21" x="616" y="602.5591">[9]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="641" y="602.5591">Check token validity</text><path d="M170,635.625 L234,635.625 L234,642.625 L224,652.625 L170,652.625 L170,635.625 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="254.3984" style="stroke: #000000; stroke-width: 2.0;" width="848" x="170" y="635.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="185" y="648.6919">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="163" x="249" y="647.8354">[&lt;access-token&gt; is valid]</text><polygon fill="#008000" points="925,760.6875,935,764.6875,925,768.6875,929,764.6875" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="609" x2="931" y1="764.6875" y2="764.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="30" x="616" y="714.2231">[10]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="650" y="668.8247">HTTP 200 OK</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="650" y="683.9575">body = {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="682" y="699.0903">"consumer":&lt;consumer&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="237" x="682" y="714.2231">"consumer-certificate-class":&lt;class&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="682" y="729.356">"expiry":&lt;expiry-time&gt;,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="682" y="744.4888">"request":&lt;request&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="650" y="759.6216">}</text><polygon fill="#0000FF" points="230,804.9531,220,808.9531,230,812.9531,226,808.9531" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="224" x2="936" y1="808.9531" y2="808.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="30" x="236" y="796.3208">[11]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="270" y="788.7544">HTTP 200 OK</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="270" y="803.8872">body=&lt;requested-data&gt;</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="170" x2="1018" y1="817.9531" y2="817.9531"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="160" x="175" y="828.1636">[Invalid &lt;access-token&gt;]</text><polygon fill="#008000" points="925,848.8906,935,852.8906,925,856.8906,929,852.8906" style="stroke: #008000; stroke-width: 1.0;"/><line style="stroke: #008000; stroke-width: 1.0;" x1="609" x2="931" y1="852.8906" y2="852.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="30" x="616" y="847.8247">[12]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="650" y="847.8247">HTTP 403 Forbidden</text><polygon fill="#0000FF" points="230,878.0234,220,882.0234,230,886.0234,226,882.0234" style="stroke: #0000FF; stroke-width: 1.0;"/><line style="stroke: #0000FF; stroke-width: 1.0;" x1="224" x2="936" y1="882.0234" y2="882.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="30" x="236" y="876.9575">[13]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="270" y="876.9575">HTTP 403 Forbidden</text><rect fill="#DDDDDD" height="58.8906" rx="5" ry="5" style="stroke: #000000; stroke-width: 1.0;" width="687" x="214.5" y="913.0234"/><text fill="#000000" filter="url(#b5yg362xgo49q0)" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="0" x="232.5" y="931.0186"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="0" x="236.5" y="931.0186"/><text fill="#FF0000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="93" x="236.5" y="931.0186">Unspecified</text><text fill="#000000" filter="url(#b5yg362xgo49q1)" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="0" x="232.5" y="947.3154"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="0" x="236.5" y="947.3154"/><text fill="#0000FF" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="435" x="236.5" y="947.3154">Server requires a valid certificate (TLS communication)</text><text fill="#000000" filter="url(#b5yg362xgo49q2)" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="0" x="232.5" y="963.6123"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="0" x="236.5" y="963.6123"/><text fill="#008000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="659" x="236.5" y="963.6123">Both parties require a valid certificate (TLS communication, mutually authenticated)</text><!--MD5=[d2541c229bb56c72c27a3552cb4ae98c]
@startuml
hide footbox

autonumber "<b>[0]"

actor "Consumer" as c


participant "IUDX Catalog server" as catalog

participant "IUDX Auth server" as auth
participant "Resource server" as rs

c -[#blue]> catalog : Search catalog for data-sets
...

c -[#green]> auth : HTTPS POST /auth/v1/token\nbody={"request" : list of resource IDs from catalog}
note left: Request for an access token

activate auth
auth -[#red]> auth : Check data provider's access control policies

alt Consumer is NOT authorized
    auth -[#green]> c : HTTP 403 Forbidden
    
else Consumer is authorized 

    auth -[#green]> c : \nHTTP 200 OK\n{\n\ttoken:<token>\n\ttoken-type:IUDX\n\texpires-in:<expiry-in-seconds>\n}
    note left: Token and its details
    deactivate auth

    ...
    
    c -[#blue]> rs : HTTPS GET <resource-server-api>\nAuthorization: IUDX <token>
    activate rs
    rs -[#green]> auth : HTTPS POST /auth/v1/token/introspect\nbody={"token": <token>}
    note right: Validate the token
    activate auth
    
    auth -[#red]> auth: Verify resource-server's identity through DNS

    auth -[#red]> auth: Check token validity

    alt <access-token> is valid
        auth -[#green]> rs : HTTP 200 OK\nbody = {\n\t"consumer":<consumer>,\n\t"consumer-certificate-class":<class>\n\t"expiry":<expiry-time>,\n\t"request":<request>\n}

        rs -[#blue]> c : HTTP 200 OK\nbody=<requested-data>
        
    else Invalid <access-token>
        auth -[#green]> rs: HTTP 403 Forbidden
        rs -[#blue]> c : HTTP 403 Forbidden
    end
    
    deactivate auth
    deactivate rs
end

legend 
<back:#red>   </back> <font color=red><b>Unspecified</b></font>
<back:blue>   </back> <font color=blue><b>Server requires a valid certificate (TLS communication)</b></font>
<back:green>   </back> <font color=green><b>Both parties require a valid certificate (TLS communication, mutually authenticated)</b></font>
endlegend
@enduml

PlantUML version 1.2020.01beta5(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.7.0_25-b15
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>